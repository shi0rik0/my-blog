<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><!-- KaTeX --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous"><!-- Prism --><link href="/src/assets/prism.css" rel="stylesheet"><script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.BC0---Bx.js"></script><meta name="generator" content="Astro v5.1.7"><title></title><link rel="stylesheet" href="/_astro/index.BCGfv0ZA.css"></head> <body class="bg-[#333] text-[#ddd]"> <h1>Sustie</h1> <div class="flex gap-4"> <a href="/">主页</a> <a href="/posts/page/1">所有文章</a> <a href="/search/">文章检索</a> </div>  <h1>在flex布局中实现按比例分配宽度或高度</h1> <h2>需求</h2> <p>假设我们有这样的布局：</p> <pre><code class="language-html">&lt;div class=&quot;flex flex-col w-[400px] h-[400px]&quot;&gt;
  &lt;div&gt;div 1&lt;/div&gt;
  &lt;div&gt;div 2&lt;/div&gt;
  &lt;div&gt;div 3&lt;/div&gt;
&lt;/div&gt;
</code></pre><p>我们希望实现这样的效果：三个 div 的高度固定按照 1:2:3 的比例分配。</p> <h2>解决方案</h2> <pre><code class="language-html">&lt;div class=&quot;flex flex-col w-[400px] h-[400px]&quot;&gt;
  &lt;div class=&quot;flex-1 min-h-0 overflow-clip&quot;&gt;div 1&lt;/div&gt;
  &lt;div class=&quot;flex-[2_0_0] min-h-0 overflow-clip&quot;&gt;div 2&lt;/div&gt;
  &lt;div class=&quot;flex-[3_0_0] min-h-0 overflow-clip&quot;&gt;div 3&lt;/div&gt;
&lt;/div&gt;
</code></pre><h2>要点解析</h2> <h3>flex-grow 和 flex-basis</h3> <p>在 Tailwind CSS 中，class <code>flex-1</code> 表示 CSS 中的属性 <code>flex: 1 1 0%</code>，<code>flex-[2_0_0]</code> 表示 <code>flex: 2 0 0</code>，<code>flex-[3_0_0]</code> 表示 <code>flex: 3 0 0</code>。而 CSS 中<code>flex: X Y Z</code>是一个缩写，相当于：</p> <pre><code class="language-css">flex-grow: X;
flex-shrink: Y;
flex-basis: Z;
</code></pre><p>其中，<code>flex-grow</code> 表示元素的放大比例，<code>flex-shrink</code> 表示元素的缩小比例，<code>flex-basis</code> 表示元素的基础大小。</p> <p>下面举个例子来说明<code>flex-grow</code>和<code>flex-basis</code>的作用，<code>flex-shrink</code>的道理是类似的。</p> <p>考虑下面的布局：</p> <pre><code class="language-html">&lt;div class=&quot;flex flex-col h-[400px]&quot;&gt;
  &lt;div class=&quot;flex-[2_0_100px]&quot;&gt;div 1&lt;/div&gt;
  &lt;div class=&quot;flex-[1_0_0]&quot;&gt;div 2&lt;/div&gt;
&lt;/div&gt;
</code></pre><p>父元素的高度是 400px，而 div 1 的 basis 是 100px，div 2 的 basis 是 0。因此，减去基础高度之后，父元素还剩下 300px 的高度可以分配，这些空间按照 2:1 的比例分配给 div 1 和 div 2，所以 div 1 的分配到的高度是 200px，div 2 是 100px。最终的效果是 div 1 的高度是 100 + 200px = 300px，div 2 的高度是 0 + 100px = 100px。</p> <h3>min-h-0</h3> <p>在解决方案中，我们还设置了<code>min-h-0</code>，也就是<code>min-height: 0</code>。这是因为在 flex 布局中，如果子元素的内容超出了子元素原本的高度，子元素会被强制拉伸，从而破坏比例分配。因此，我们需要设置<code>min-height: 0</code>来让溢出的内容不会影响到父元素的高度。</p> <h3>overflow-clip</h3> <p>经过上面的设置，现在 div block 的高度已经没问题了，但是 div 里面的内容还是可能会溢出。因为在 HTML 中，并没有规定元素的内容（比如文本）不能超出元素的边界。因此，我们需要设置<code>overflow-clip</code>来截断溢出的内容，也可以设置<code>overflow-auto</code>来显示一个滚动条。</p> <h3>关于 padding 和 border 要注意的地方</h3> <p>这里有一个细节，就是 padding 和 border 也会影响元素的基础宽度或高度，从而破坏比例分配。StackOverflow 上有一个专门讨论这个问题的帖子：<a href="https://stackoverflow.com/questions/33145242/why-is-padding-expanding-a-flex-item">Why is padding expanding a flex item?</a>。</p> <p>简单来说，问题出在<code>flex-basis</code>的计算上。最终生效的<code>flex-basis</code>的值是按照下面的公式计算的：</p> <pre><code>real_flex_basis = max(flex_basis, padding + border)
</code></pre><p>下面是一些解决办法：</p> <ol> <li>如果没有强迫症的话，就不管这个问题。反正一般情况下 padding 和 border 不会太大，不会对比例分配产生太大的影响。</li> <li>设置 padding 和 border 都为 0。</li> <li>如果需要设置 padding 或 border，可以手动将<code>flex-basis</code>设置成一个符合比例的同时又略微大于 padding + border 的值。</li> </ol>  </body></html>