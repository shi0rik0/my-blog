<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><!-- KaTeX --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous"><!-- Prism --><link href="/lib/prism.css" rel="stylesheet"><script src="/lib/prism.js"></script><meta name="generator" content="Astro v5.1.7"><title></title><link rel="stylesheet" href="/_astro/index.CCeQH6Bz.css"></head> <body class="bg-[#333] text-[#ddd]"> <h1>Sustie</h1> <div class="flex gap-4"> <a href="/">主页</a> <a href="/posts/page/1">所有文章</a> <a href="/search/">文章检索</a> </div>  <h1>Pinia快速入门</h1> <p>Pinia 是 Vue 3 官方的状态管理库，通俗点说就是可以给 Vue 应用程序提供一个“全局变量”。Pinia 的基本使用方法非常简单。</p> <h2>导入 Pinia</h2> <p>首先，我们需要安装 Pinia：</p> <pre><code class="language-bash">npm install pinia
</code></pre><p>然后在 Vue 3 项目中导入 Pinia：</p> <pre><code class="language-js">import &#123; createApp &#125; from 'vue'
import &#123; createPinia &#125; from 'pinia' // &lt;--
import App from './App.vue'

const pinia = createPinia() // &lt;--
const app = createApp(App)

app.use(pinia) // &lt;--
app.mount('#app')
</code></pre><h2>创建一个 Store</h2> <p>Store 是 Pinia 的一个核心概念，简单来说就是一组全局变量集合。我们可以通过 <code>defineStore</code> 函数来创建一个 Store：</p> <pre><code class="language-js">import &#123; defineStore &#125; from 'pinia'

export const useExampleStore = defineStore('example', &#123;
  state: () =&gt; (&#123;
    count: 0,
  &#125;),
  getters: &#123;
    doubleCount: (state) =&gt; state.count * 2,
  &#125;,
  actions: &#123;
    increment() &#123;
      this.count++
    &#125;,
  &#125;,
&#125;)
</code></pre><p><code>defineStore</code>函数接受两个参数，第一个参数是 Store 的全局 ID，第二个参数是 Store 的配置。配置中包含了 <code>state</code>、<code>getters</code> 和 <code>actions</code> 三个属性，分别用来定义 Store 的状态、计算属性和方法。</p> <h2>使用 Store</h2> <p>在 Vue 组件中使用 Store 非常简单，只要 import 并调用 Store 的 use 函数即可：</p> <pre><code class="language-vue">&lt;script setup&gt;
import &#123; useExampleStore &#125; from '../stores/example'

const store = useExampleStore()
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;Count: &#123;&#123; store.count &#125;&#125;&lt;/p&gt;
    &lt;p&gt;Double Count: &#123;&#123; store.doubleCount &#125;&#125;&lt;/p&gt;
    &lt;button @click=&quot;store.increment&quot;&gt;Increment&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre><p>要注意，Store 对象本身就是响应式的，所以读取或修改状态的时候不需要使用<code>.value</code>:</p> <pre><code class="language-vue">&lt;script setup&gt;
import &#123; useExampleStore &#125; from '../stores/example'

const store = useExampleStore()

const increment = () =&gt; &#123;
  // 错误的写法：store.count.value++
  store.count++
&#125;
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;Count: &#123;&#123; store.count &#125;&#125;&lt;/p&gt;
    &lt;button @click=&quot;increment()&quot;&gt;Increment&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre><h2>深入 state</h2> <p>在定义<code>state</code>的时候，Pinia 会自动推断类型，但是有时候我们需要手动指定类型：</p> <pre><code class="language-ts">defineStore('example', &#123;
  state: () =&gt; (&#123;
    names: [] as string[],
  &#125;),
&#125;)
</code></pre><h2>深入 getters</h2> <p>在 getter 中访问 state 的时候利用 state 参数（第一个参数）就可以了。如果希望在 getter 中使用其他 getter，可以使用<code>this</code>关键字，但是这时候就<strong>不能</strong>使用箭头函数了，并且这时候还需要手动指定返回值类型：</p> <pre><code class="language-ts">defineStore('example', &#123;
  getters: &#123;
    doubleCount: (state) =&gt; state.count * 2,
    quadrupleCount(state): number &#123;
      return this.doubleCount * 2
    &#125;,
  &#125;,
&#125;)
</code></pre><h2>深入 actions</h2> <p>一个 action 可以是异步函数。</p> <p>在 action 中，可以直接访问其他 state、getter 和 action，并且都是通过<code>this</code>来访问，因此 action 也不能是箭头函数。</p>  </body></html>